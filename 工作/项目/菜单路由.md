# 介绍接口返回的数据

登录以后，会调取页面权限这个接口。接口的返回是一个数组

里面的内容是 菜单是否可见,是否可以点击 然后该菜单下一般来说还会有个 children 数组来，就像是

项目中心下,还会有子节点 比如说 项目列表 持续督导管理 底稿报送

持续督导项目管理下也会有 持续督导项目库 流程查询 项目库统计... 等等的子节点

这些菜单 现在都是通过后台接口进行遍历的，每个菜单下还会有页面资源这个数组，来控制该该菜单路由

的具体信息，比如说 页面的路由地址，类型，id 这些

# 这里方法 我写到了 models 文件夹中写一个 route 的 ts 文件

## 处理菜单的方法

入参来说是 整个 data 数据,还有这个 id type 他是 最外层的菜单 还是每一列菜单下的子菜单 菜单数组这个集合

### 处理 father

如果说 father 的话 相当于是页面登录的导航栏 直接就 push 进 arr 这个菜单数组中了
还需要继续展开导航栏菜单下的每一列子菜单
看 children 的长度，存在的话，进行 forEach 遍历里面的 item 进行拼装数据 再给塞进 arr 菜单数组中
只要 children 长度还存在 那就不断使用递归来调用这个方法

### 处理子菜单 一直处理到最后一级

子菜单只要里面的 children 的长度还存在 就不断递归调用

## 生成菜单数组 页面数组 按钮数组

看下入参是不是一个数组
是的话 就去处理每一个菜单

# 使用 effects

因为 umi 发送异步的话 使用 effects
它是一种类型的 action 主要是用于和后端的异步通讯
使用 effects 请求发送和接收数据可以使用 put 方法再发次发送一次 reducer 来修改数据
effect 是通过 ES6 中的 Generator 函数来支持通过顺序的代码来实现异步的请求

## put 用于触发 action

需要带上 那个 reducer 还有 payload 载荷
yield put({type:'setPageList', payload:'pageList'})

## call 用于调用异步的逻辑 支持 promise

yield call(getMenuListAndPagePermissions)
